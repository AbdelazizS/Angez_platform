import{u as L,r,j as e,Q as P,b as n,S as Q,C as g}from"./app-tu_nxz4H.js";import{B as c}from"./button-BZgJU16f.js";import{I as V}from"./input--XoPGThR.js";import{T as X}from"./textarea-BFctAIp6.js";import{B as I}from"./badge-YbPNhPcJ.js";import{C as b,a as f,b as y,d as J,c as w}from"./card-Bw0vLuEn.js";import{D as K,g as Y,a as Z,b as q,c as ee,d as se}from"./dialog-BuNxXWGd.js";import{T as ae,a as te,b as le,c as p,d as re,e as x}from"./table-ByW5kVZj.js";import{R as ie,C as oe,a as ne}from"./index-Be41AUdn.js";import{F as ce}from"./FreelancerDashboardLayout-Drmnvfzb.js";import{W as de}from"./wallet-df-tNZSa.js";import{S as $}from"./send-DjQ49j8w.js";import{B as z}from"./banknote-BHqKonmc.js";import{F as H}from"./file-text-CsIm62FH.js";import{A as me}from"./index-Dx2ImkKf.js";import{m as A}from"./proxy-CXAJgvNI.js";import{C as pe}from"./credit-card-Bb6y7JVl.js";import{D as xe}from"./dollar-sign-CicZaffH.js";import{D as E}from"./download-ynPO2CN2.js";import{C as ue}from"./chevron-up-5hDX3Am3.js";import{C as he}from"./chevron-down-DgvoPxKv.js";import{C as je}from"./circle-x-CweIOvyj.js";import{C as ge}from"./clock-BbigxC4A.js";import"./sheet-2K7jSFhM.js";import"./index-CPefrJt7.js";import"./index-DEJTFC4Z.js";import"./index-CUWVWZD9.js";import"./index-CZg7sQom.js";import"./index-Du654uGJ.js";import"./index-Bzb9Ony0.js";import"./AppHeader-B8kkmwh_.js";import"./dropdown-menu-XeOzj3G4.js";import"./chevron-right-DdsKMi0-.js";import"./LanguageDropdown-Czorzu0A.js";import"./loader-circle-CylYfSfh.js";import"./avatar-Br7MV_1H.js";import"./log-out-C_P4AYsR.js";import"./separator-C-d7tlPr.js";import"./skeleton-CNspO5WR.js";import"./index-C4bozPq7.js";import"./package-C35wEl39.js";import"./message-square-BLldBHH5.js";const be=ie,fe=oe,ye=ne,i=l=>new Intl.NumberFormat("en-US").format(l),u=l=>new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),N={pending:{icon:e.jsx(ge,{className:"w-4 h-4 text-yellow-500"}),color:"bg-yellow-100 text-yellow-800",label:"Pending"},approved:{icon:e.jsx(g,{className:"w-4 h-4 text-green-500"}),color:"bg-green-100 text-green-800",label:"Approved"},rejected:{icon:e.jsx(je,{className:"w-4 h-4 text-red-500"}),color:"bg-red-100 text-red-800",label:"Rejected"},paid:{icon:e.jsx(g,{className:"w-4 h-4 text-blue-500"}),color:"bg-blue-100 text-blue-800",label:"Paid"},payout_paid:{icon:e.jsx(g,{className:"w-4 h-4 text-green-500"}),color:"bg-green-100 text-green-800",label:"Completed"}};function cs({wallet:l,transactions:_,payoutRequests:v,canRequestPayout:C,minPayoutAmount:o=2e5}){const{t:a}=L(),[M,d]=r.useState(!1),[D,S]=r.useState(""),[T,k]=r.useState(""),[h,F]=r.useState(!1),[j,O]=r.useState(null),B=r.useMemo(()=>[..._.data].sort((s,t)=>new Date(t.created_at).getTime()-new Date(s.created_at).getTime()),[_.data]),R=r.useMemo(()=>[...v.data].sort((s,t)=>new Date(t.requested_at).getTime()-new Date(s.requested_at).getTime()),[v.data]),U=async s=>{s.preventDefault(),F(!0);try{const t=parseFloat(D);if(t<o){n.error(`Minimum payout amount is ${i(o)} SDG`);return}if(t>l.balance){n.error("Requested amount exceeds your current balance");return}await Q.post(route("freelancer.wallet.payout"),{amount:t,bank_account_details:T},{onSuccess:()=>{d(!1),S(""),k(""),n.success(a("wallet.payout_request_submitted"))},onError:m=>{n.error(m.message||"Failed to submit payout request")}})}catch{n.error("An unexpected error occurred")}finally{F(!1)}},W=s=>{O(j===s?null:s)};return e.jsxs(ce,{children:[e.jsx(P,{title:a("wallet.title")}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(b,{className:"bg-gradient-to-r rtl:bg-gradient-to-l from-primary/90 to-primary/60 text-white shadow-lg",children:[e.jsxs(f,{className:"pb-4",children:[e.jsxs(y,{className:"flex items-center gap-3 text-xl",children:[e.jsx(de,{className:"w-6 h-6"}),a("wallet.current_balance")]}),e.jsx(J,{className:"text-blue-100",children:a("wallet.available_funds")})]}),e.jsx(w,{children:e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-4xl font-bold mb-2",children:[i(l.balance)," SDG"]}),e.jsxs("p",{className:"text-blue-100 text-sm",children:[a("wallet.last_updated"),":"," ",u(new Date().toISOString())]})]}),C?e.jsxs(K,{open:M,onOpenChange:d,children:[e.jsx(Y,{asChild:!0,children:e.jsxs(c,{className:"bg-white text-blue-600 hover:bg-gray-50 shadow-md",size:"lg",children:[e.jsx($,{className:"w-5 h-5 mr-2"}),a("wallet.request_payout")]})}),e.jsxs(Z,{className:"sm:max-w-md",children:[e.jsx(q,{children:e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5"}),a("wallet.request_payout")]})}),e.jsxs("form",{onSubmit:U,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[a("wallet.amount")," (min"," ",i(o)," ","SDG)"]}),e.jsx(V,{type:"number",value:D,onChange:s=>S(s.target.value),min:o,max:l.balance,required:!0,placeholder:a("wallet.enter_amount"),className:"text-lg py-3"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[a("wallet.available_balance"),":"," ",i(l.balance)," ","SDG"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:a("wallet.bank_details")}),e.jsx(X,{value:T,onChange:s=>k(s.target.value),required:!0,placeholder:a("wallet.enter_bank_details"),rows:4})]}),e.jsxs(se,{children:[e.jsx(c,{type:"button",variant:"outline",onClick:()=>d(!1),disabled:h,children:a("common.cancel")}),e.jsx(c,{type:"submit",disabled:h,className:"min-w-32",children:h?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a("wallet.submitting")]}):a("wallet.submit_request")})]})]})]})]}):e.jsx("div",{className:"bg-blue-500/20 p-3 rounded-lg border border-blue-400/30",children:e.jsx("p",{className:"text-sm",children:a("wallet.minimum_payout_notice",{amount:i(o)})})})]})})]}),e.jsxs(b,{children:[e.jsx(f,{children:e.jsxs(y,{className:"flex items-center gap-3 text-lg",children:[e.jsx(H,{className:"w-5 h-5"}),a("wallet.transaction_history")]})}),e.jsx(w,{children:B.length>0?e.jsxs(ae,{children:[e.jsx(te,{children:e.jsxs(le,{children:[e.jsx(p,{children:a("wallet.description")}),e.jsx(p,{children:a("wallet.date")}),e.jsx(p,{className:"text-right",children:a("wallet.amount")}),e.jsx(p,{children:a("wallet.status")})]})}),e.jsx(re,{children:e.jsx(me,{children:B.map(s=>e.jsxs(A.tr,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"hover:bg-muted/50",children:[e.jsx(x,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.type.includes("payout")?e.jsx(pe,{className:"w-4 h-4 text-blue-500"}):e.jsx(xe,{className:"w-4 h-4 text-green-500"}),s.description]})}),e.jsx(x,{children:u(s.created_at)}),e.jsxs(x,{className:`text-right font-semibold ${s.type==="payout_paid"?"text-blue-600":s.amount>0?"text-green-600":"text-red-600"}`,children:[s.type==="payout_paid"?"âœ“ ":"",s.amount>0?"+":"",i(s.amount)," ","SDG"]}),e.jsx(x,{children:e.jsx(I,{variant:"outline",className:"capitalize text-xs",children:s.type==="payout_paid"?a("wallet.paid"):s.type==="payout_request"?a("wallet.payout_request"):s.type==="payout_approved"?a("wallet.payout_approved"):s.type==="payout_rejected"?a("wallet.payout_rejected"):s.type==="credit"?a("wallet.credit"):s.type})})]},s.id))})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx(H,{className:"w-12 h-12 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:a("wallet.no_transactions")})]})})]}),e.jsxs(b,{children:[e.jsx(f,{children:e.jsxs(y,{className:"flex items-center gap-3 text-lg",children:[e.jsx(E,{className:"w-5 h-5"}),a("wallet.payout_requests")]})}),e.jsx(w,{children:R.length>0?e.jsx("div",{className:"space-y-3",children:R.map(s=>{var t,m,G;return e.jsx(A.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"border rounded-lg overflow-hidden",children:e.jsxs(be,{open:j===s.id,onOpenChange:()=>W(s.id),children:[e.jsx("div",{className:"p-4 hover:bg-muted/50 transition-colors cursor-pointer",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:e.jsx(z,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.amount>0?`${i(s.amount)} SDG`:(s.status==="payout_paid"||s.status==="paid")&&s.payment_proof?a("wallet.payment_completed"):a("wallet.amount_not_specified")}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[a("wallet.requested"),":"," ",u(s.requested_at)]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(I,{className:`${(t=N[s.status])==null?void 0:t.color} px-3 py-1`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[(m=N[s.status])==null?void 0:m.icon,e.jsx("span",{children:(G=N[s.status==="approved"&&s.payment_proof?"payout_paid":s.status])==null?void 0:G.label})]})}),e.jsx(fe,{asChild:!0,children:e.jsxs(c,{variant:"ghost",size:"sm",className:"w-9 p-0",children:[j===s.id?e.jsx(ue,{className:"h-4 w-4"}):e.jsx(he,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle"})]})})]})]})}),e.jsxs(ye,{className:"px-4 pb-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:a("wallet.bank_details")}),e.jsx("p",{className:"text-sm",children:s.bank_account_details||a("wallet.not_provided")})]}),(s.status==="paid"||s.status==="payout_paid")&&s.payment_proof&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:a("wallet.payment_details")}),e.jsxs("p",{className:"text-sm",children:[a("wallet.paid_on"),":"," ",u(s.payment_proof.created_at)]}),e.jsxs("p",{className:"text-sm",children:[a("wallet.reference"),":"," ",s.payment_proof.reference_number]})]})]}),s.admin_notes&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-100",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-1",children:a("wallet.admin_notes")}),e.jsx("p",{className:"text-sm text-blue-700",children:s.admin_notes})]})]})]})},s.id)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx(E,{className:"w-12 h-12 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:a("wallet.no_payout_requests")}),C&&e.jsxs(c,{variant:"outline",onClick:()=>d(!0),children:[e.jsx($,{className:"w-4 h-4 mr-2"}),a("wallet.request_payout")]})]})})]})]})]})}export{cs as default};
